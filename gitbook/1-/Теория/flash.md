**Flash-память** — это энергонезависимая перезаписываемая полупроводниковая память. Она **сохраняет данные при отключении питания** (в отличие от ОЗУ) и позволяет многократно записывать и стирать информацию (в отличие от ПЗУ).    

---

## **Основные характеристики**

### **1. Энергонезависимость**

Сохраняет данные **без питания** (как SSD, флешка, карта памяти).

### **2. Ограниченное число циклов перезаписи**

- **NOR Flash:** ~10⁵ — 10⁶ циклов
    
- **NAND Flash:** ~10³ — 10⁵ циклов
    
- **Важно:** Для микроконтроллеров это означает, что частое обновление прошивки в одном секторе может износить память.
    

### **3. Особенности доступа**

- **Чтение:** Произвольный доступ (можно читать с любого адреса)
    
- **Запись:** Только из 1 в 0 (битово)
    
- **Стирание:** Только целыми **секторами/страницами** (из 0 в 1)
    

---

## **Архитектура и организация**

### **Базовый элемент: транзистор с плавающим затвором**

text

┌─────────────────────┐
│  Управляющий затвор │ ← Подаём высокое напряжение
├─────────────────────┤
│  Диэлектрик (оксид) │
├─────────────────────┤
│  **Плавающий затвор**│ ← Хранит заряд (электроны)
├─────────────────────┤
│  Канал транзистора  │
└─────────────────────┘

- **Есть заряд** = бит 0 (не проводит)
    
- **Нет заряда** = бит 1 (проводит)
    

### **Типы Flash-памяти в МК:**

|Тип|Размер ячейки|Хранение|Скорость записи|Стоимость|Где используется|
|---|---|---|---|---|---|
|**NOR Flash**|1 бит|Надёжное|Медленная|Высокая|**Хранение кода (прошивки) МК**, быстрый доступ на чтение|
|**NAND Flash**|1+ бит (MLC/TLC)|Менее надёжное|Быстрая|Низкая|Флешки, SSD, карты памяти (внешняя память)|

---

## **Как организована Flash в микроконтроллере?**

### **Типичная структура (на примере STM32):**

text

Адресное пространство Flash памяти МК:
0x0800 0000 ┌─────────────────┐ ← Начало прошивки
            │     Сектор 0     │    16 КБ
0x0800 4000 ├─────────────────┤
            │     Сектор 1     │    16 КБ
0x0800 8000 ├─────────────────┤
            │     Сектор 2     │    16 КБ
0x0800 C000 ├─────────────────┤
            │     Сектор 3     │    16 КБ
0x0801 0000 ├─────────────────┤
            │     Сектор 4     │    64 КБ
0x0802 0000 ├─────────────────┤
            │     Сектор 5     │   128 КБ
            │                 │
            └─────────────────┘

- **Сектор** — минимальная единица стирания (например, 2-128 КБ)
    
- **Страница** — минимальная единица записи (например, 256 байт)
    
- **Слово** — минимальная единица программирования (например, 32 бита)
    

---

## **Три основных операции с Flash**

### **1. Чтение (READ)**

- **Как:** Обращение по адресу (как к ОЗУ)
    
- **Время:** Быстро (~50-100 МГц)
    
- **Пример:** МК читает команды своей прошивки
    

### **2. Программирование/Запись (PROGRAM/WRITE)**

- **Как:** Побитовое изменение 1 → 0
    
- **Особенность:** Нельзя изменить 0 → 1 без стирания!
    
- **Пример:** Запись данных лога, обновление калибровочных коэффициентов
    

### **3. Стирание (ERASE)**

- **Как:** Установка всех битов сектора в 1 (0xFF...)
    
- **Минимальный размер:** Целый сектор
    
- **Время:** Медленно (десятки-сотни миллисекунд)
    
- **Пример:** Обновление прошивки (сначала стираем сектор, потом пишем новую)