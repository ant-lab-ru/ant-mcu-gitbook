---
тема: Управляемый светодиод
автор: Егор Анатольевич Денисов
дата: 2026-02-11
---

# Результат

- [ ] в протокол добавлена команда mem;
- [ ] команда mem принимает один аргумент: uint32_t addr;
- [ ] команда mem читатет по этому адресу слово из адрессного пространства МК и возвращает его пользователю;
- [ ] в протокол добавлена команда wmem;
- [ ] команда wmem принимает два аргумента: uint32_t addr и uint32_t value;
- [ ] команда wmem записывает значение value по адресу addr;
- [ ] прошивка скомпилирована и запущена;
- [ ] командой mem считан указатель на стэк;
- [ ] командой wmem включен светодиод.

1. Добавить в протокол  команду ```mem``` с одним аргументом в hex (16-ая система счисления). Эта команда должна выводить значение лежащее по указанному адресу.
2. Чтобы проверить корректность работы команды ```mem``` :
	- найдите адрес переменной ```LED_BLINK_PERIOD_US``` в ```02_control.elf.map``` файле, который находится в папке ```build```
	- Сравните значение указанное Вами через терминал и значение считанное из регистра.
 3. Добавить в протокол  команду ```wmem``` с двумя аргументами в hex (16-ая система счисления). Первый аргумент указывает адрес, куда нужно записать значение, второй - значение.
 4. Для того чтобы проверить корректность работы команды ```wmem``` требуется включить светодиод командой ```wmem``` через регистры. Ниже приведена инструкция как найти ее аргументы.
 5. Определить адрес регистра для записи:
	- Найдите в datasheet rp2040 базовый адрес и смещение для регистров с именем ```GPIO_OUT_SET``` (установка значения включает светодиод) и ```GPIO_OUT_CLR``` (установка значения выключает светодиод). 
	- Из найденных параметров определите адрес по котором необходимо осуществить запись
6. Определить значение, которое необходимо записать в найденный адрес регистра.

   > [!ATTENTION] Подсказка
> В RP2040 в SIO один 32‑битный регистр управляет GPIO0…GPIO29. Для того чтобы включить GPIO N нужно выставить N-ый бит в 1
7. После того как определены аргументы для команды ```wmem``` нужно перевести контроллер в состояние мигания и увеличить период миганий до 10 с
  >[!ATTENTION] Обратите внимание
   >Дело в том, что в соответствии с нашей прошивкой МК находится в состоянии ```LED_STATE_OFF```. Таким образом если мы просто запишем значение в регистр для включения, то, при прохождении одной итерации цикла, это состояние перезапишется на следующей итерации 

8. Теперь можно убедиться в том, что включение/выключение светодиода через регистр работает.