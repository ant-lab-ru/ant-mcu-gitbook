---
тема: Управляемый светодиод
автор: Егор Анатольевич Денисов
дата: 2026-02-11
---

# Результат

- [ ] в модуле `led-task` создана функция `led_task_set_blink_period_ms(uint32_t period_ms)`;
- [ ] в протокол добавлена команда `set_period`;
- [ ] создан обработчик команды `led_blink_set_period_ms_callback`, который обрабатывает принятые аргументы
- [ ] при отправке команды `set_period 1000` период мигания светодиода становится 1 с.
- [ ] при отправке команды `set_period 2000` период мигания светодиода становится 2 с.
- [ ] при отправке команды `set_period 3000` период мигания светодиода становится 3 с.

## Инструкция

1. в файл `led-task.h` добавить прототип функции `void led_task_set_blink_period_ms(uint32_t period_ms)`;
2. в файл `led-task.c` добавить библиотеку ```"stdint.h"``` для работы с типами (`uint32_t`) 
3. в файле `led-task.c` добавить реализацию функции `led_task_set_blink_period_ms`, которая будет выставлять значение глобальной переменной `LED_BLINK_PERIOD_US`.

   >[!ATTENTION] Обратите внимание
   >Переменная `LED_BLINK_PERIOD_US` в микросекундах, аргумент функции в миллисекундах

4. в main.c создать функцию `led_blink_set_period_ms_callback`
	- в функции необходимо обработать строку `args` при помощи функции `sscanf`:

``` c
uint period_ms = 0;
sscanf(args, "%u", &period_ms);
```

4. если `period_ms` имеет нулевое значение, вывести сообщение об ошибке через `printf` и выйти из функции;

5. вызвать функцию `led_task_set_blink_period_ms` передав в нее `period_ms`

6. в `main.c` добавить в `device_api` команду `set_period`

7. скомпилировать прошивку, загрузить в RP2040, проверить работоспособность. На отправленную команду `set_period 2000` в COM-порт, при включенном мигании, светодиод должен мигать с периодом 2 секунды.