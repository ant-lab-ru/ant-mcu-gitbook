---
тема: Измерительный прибор
автор: Егор Анатольевич Денисов
дата: 2026-02-17
---

# Результат

- [ ] В модуль `adc-task` добавлена функция измерения температуры RP2040 через АЦП и встроенный датчик температуры
- [ ] В API устройства добавлена функция измерения температуры `get_temp`
- [ ] Прошивка скомпилирована, запущена, при вызове команды `get_temp` в COM-порт выводится температура RP2040
- [ ] Температура похожа на реальную

# Инструкция

1. В инициализацию `adc-task` добавить включение встроенного датчика температуры:

``` c
adc_set_temp_sensor_enabled(true);
```

2. В `adc-task.c` создать константу с номером канала АЦП, подключенного к датчику температуры. Номер канала 4.
3. Создать функцию измерения температуры, в которой нужно выполнить следующие действия:
	- выбрать канал АЦП для измерения
	- запустить измерение и считать значение
	- преобразовать значение в отсчетах (`uint16_t temp_counts`) в значение в вольтах (`float temp_V`)
	- преобразовать значение температуры в вольтах в значение в градусах цельсия:

``` c
float temp_C = 27.0f - (temp_V - 0.706f) / 0.001721f;
```

> [!INFO] Справка
> Формула взята из datasheet RP2040

4. В API устройства добавить команду с названием `get_temp`. В ее callback вызвать функцию измерения температуры, вывести в терминал значение:

``` c
printf("%f\n", temp_C);
```

> [!ATTENTION] Обратите внимание!
> Оставьте этот вывод именно в таком формате, чтобы Python скрипт, который мы напишем позже, корректно обрабатывал вывод температуры.

11. скомпилировать прошивку, загрузить в RP2040, проверить работоспособность. На вызов команды `get_temp`, RP2040 должен возвращать в COM-порт измеренную температуру чипа.